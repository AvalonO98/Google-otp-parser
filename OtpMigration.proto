syntax = "proto3";

message MigrationPayload {
  repeated OtpParameters otp_parameters = 1;
  int32 version = 2;
  int32 batch_size = 3;
  int32 batch_index = 4;
  int32 batch_id = 5;
}

message OtpParameters {
  bytes secret = 1;
  string name = 2;
  string issuer = 3;
  int32 type = 4;  // 1: HOTP, 2: TOTP
  int64 counter = 5;
  int32 algorithm = 6;  // 1: SHA1, 2: SHA256, 3: SHA512
  int32 digits = 7;     // 6: 6位验证码, 8: 8位
  int32 period = 8;     // TOTP周期（默认30秒）
}